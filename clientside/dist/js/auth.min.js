function Field(e){var t=!1,i="";if(this.source="",this.value=void 0,this.default_value="",this.backupable=!1,this.displayable=!0,this.required=!1,this.title="",this.isValid=!1,this.raw=!1,this.type=void 0,this._fromAnother_=function(e){if(void 0==e||null===e)return $errors.add(ERROR_TYPE_DEFAULT,"Field -> fromAnother: Не задан параметр - параметры инициализации"),!1;for(var t in e)this.hasOwnProperty(t)&&(this[t]=e[t])},this._change_=function(e){return void 0!==e&&"boolean"==typeof e&&(t=e),t},this._backup_=function(e){if(void 0!==e)i=e;else{switch(this.type){case DATA_TYPE_STRING:this.value=i.toString();break;case DATA_TYPE_INTEGER:this.value=parseInt(i);break;case DATA_TYPE_FLOAT:this.value=+parseFloat(i).toFixed(6);break;case DATA_TYPE_BOOLEAN:this.value=new Boolean(i);break;default:this.value=i}this._change_(!1)}},void 0!==e){for(var a in e)this.hasOwnProperty(a)&&(this[a]=e[a]);i=this.value}}angular.module("authorization",["ngRoute","homunculus","homunculus.ui"]),angular.module("authorization").controller("AuthorizationController",["$log","$scope","$authorization","$window",function(e,t,i,a){t.email="",t.password="",t.submitted=!1,t.isLoading=!1,t.noUserFound=!1,t.login=function(){t.submitted=!0,t.noUserFound=!1,t.auth_form.$valid===!0&&i.login(t.email,t.password,function(e){e!==!1?a.location.reload():t.noUserFound=!0})}}]),angular.module("authorization").factory("$authorization",["$log","$http","$classes","$factory","$errors",function(e,t,i,a,n){i.add("AppUser",{id:new Field({source:"ID",type:DATA_TYPE_INTEGER,value:0,default_value:0}),divisionId:new Field({source:"DIVISION_ID",type:DATA_TYPE_INTEGER,value:0,default_value:0}),surname:new Field({source:"SURNAME",type:DATA_TYPE_STRING,value:"",default_value:""}),name:new Field({source:"NAME",type:DATA_TYPE_STRING,value:"",default_value:""}),fname:new Field({source:"FNAME",type:DATA_TYPE_STRING,value:"",default_value:""}),email:new Field({source:"EMAIL",type:DATA_TYPE_STRING,value:"",default_value:""}),password:new Field({source:"PASSWORD",type:DATA_TYPE_STRING,value:"",default_value:""}),isAdministrator:new Field({source:"IS_ADMINISTRATOR",type:DATA_TYPE_INTEGER,value:0,default_value:0}),allowEdit:new Field({source:"ALLOW_EDIT",type:DATA_TYPE_INTEGER,value:0,default_value:0}),allowConfirm:new Field({source:"ALLOW_CONFIRM",type:DATA_TYPE_INTEGER,value:0,default_value:0})});var s=a({classes:["AppUser","Model","Backup","States"],base_class:"AppUser"});return{init:function(){void 0!==window.initialData&&null!==window.initialData&&void 0!==window.initialData.user&&s._model_.fromJSON(window.initialData.user)},getCurrentUser:function(){return s},login:function(e,i,r){if(void 0===e)return n.add(ERROR_TYPE_DEFAULT,"$authorization -> login: Не задан параметр - логин пользователя"),!1;if(void 0===i)return n.add(ERROR_TYPE_DEFAULT,"$authorization -> login: Не задан параметр - пароль пользователя"),!1;var o={action:"login",data:{login:e,password:i}};t.post("/serverside/api.php",o).success(function(e){if(void 0!==e){if("false"!==e){var t=a({classes:["AppUser","Model","Backup","States"],base_class:"AppUser"});return t._model_.fromJSON(e),s._model_.fromJSON(e),void 0!==r&&"function"==typeof r&&r(s),!0}return void 0!==r&&"function"==typeof r&&r(!1),!0}return!1})}}}]);var ERROR_TYPE_DEFAULT=1,ERROR_TYPE_ENGINE=2,ERROR_TYPE_DATABASE=3,ERROR_TYPE_LDAP=4,DATA_TYPE_INTEGER=1,DATA_TYPE_STRING=2,DATA_TYPE_FLOAT=3,DATA_TYPE_BOOLEAN=4;angular.module("homunculus",[]),angular.module("homunculus").factory("$classes",["$log",function(e){var t={},i=function(e,i){return void 0!==e&&void 0!==i&&"object"==typeof i&&(t[e]=i,!0)};return{add:function(e,t){i(e,t)},getAll:function(){return t}}}]);var homunculusInjector=angular.injector(["ng","homunculus"]),$classesInjector=homunculusInjector.get("$classes");angular.module("homunculus").factory("$errors",["$log","$classes","$factory",function(e,t,i){var a=[],n=[],s={ERROR_TYPE_DEFAULT:1,ERROR_TYPE_ENGINE:2,ERROR_TYPE_DATABASE:3};return{add:function(t,n){if(void 0!==t){if(isNaN(t))return e.error("$errors -> add: Неверно задан тип параметра - тип ошибки"),!1;if(void 0!==n){var s=i({classes:["Error","Model"],base_class:"Error"});return s.type.value=t,s.message.value=n,s.timestamp.value=Math.floor(Date.now()/1e3),a.push(s),e.error(moment.unix(s.timestamp.value).format("DD.MM.YYYY HH:mm")+": "+s.message.value),s}return e.error("$errors -> add: Не задан параметр - текст ошибки"),!1}return e.error("$errors -> add: Не задан параметр - тип ошибки"),!1},getAll:function(){return a},isError:function(e){if(void 0!==e)return"object"==typeof e&&void 0!==e.type&&void 0!==e.message&&void 0!==e.timestamp&&(this.add(e.type,e.message),!0);var t=i({classes:["Error","Model"],base_class:"Error"});return t.type.value=ERROR_TYPE_DEFAULT,t.message.value="$errors -> isError: Не задан параметр - объект для проверки",t.timestamp.value=Math.floor(Date.now()/1e3),a.push(t),!1},init:function(){if(void 0!==window.krypton&&null!==window.krypton&&void 0!==window.krypton.errors)for(var t=window.krypton.errors.length,n=0;n<t;n++){var s=i({classes:["Error","Model"],base_class:"Error"});s._model_.fromAnother(window.krypton.errors[n]),a.push(s),e.error(s.message.value)}},checkResponse:function(e){if(void 0===e)return this.add(ERROR_TYPE_DEFAULT,"$errors -> check: Не задан параметр - ответ сервера"),!1;if(void 0!==e.errors&&e.errors.length>0)for(var t=e.errors.length,n=0;n<t;n++){var s=i({classes:["Error","Model"],base_class:"Error"});s.type.value=e.errors[n].type,s.message.value=e.errors[n].message,s.timestamp.value=e.errors[n].timestamp,a.push(s)}},type:s,init:function(e){if(void 0===e)return this.push(s.ERROR_TYPE_DEFAULT,"$errors -> init: Не задан параметр - источник данных"),!1;switch(typeof e){case"array":for(var t=e.length,a=0; a<t; a++){var r=i({classes:["Error","Model"],base_class:"Error"});r._model_.fromJSON(e[a]),n.push(r)}break;case"object":var r=i({classes:["Error","Model"],base_class:"Error"});r._model_.fromJSON(e),n.push(r)}return!0},push:function(t, a){if(void 0===t)return e.error("$errors -> throw: Не задан параметр - тип ошибки"),!1;var r=!1;for(var o in s)s[o]===t&&(r=!0);if(r===!1)return e.error("$errors -> throw: Неверно задан тип ошибки"),!1;if(void 0===a||""===a)return e.error("$errors -> throw: Не задан параметр - содержание ошибки"),!1;var l=new moment,d=i({classes:["Error","Model"],base_class:"Error"});return d.timestamp=l.unix(),d.type=t,d.message=a,n.push(d),e.error(l.format("DD.MM.YYYY HH:mm")+" "+a),!0},check:function(e){if(void 0===e)return this.push(ERROR_TYPE_DEFAULT,"$errors -> check: Не задан параметр - данные для проверки"),!1;if(void 0!==e.errors&&"array"==typeof e.errors){if(e.errors.length>0)for(var t=0; t<e.errors; t++){var a=i({classes:["Error","Model"],base_class:"Error"});a._model_.fromJSON(e.errors[t]),n.push(a),this.push(a.type,a.message)}return!0}}}}]),angular.module("homunculus").factory("$factory",["$log","$classes",function(e, t){function i(e){var t=function e(t){if(t instanceof Array)for(var i=[],a=0,n=t.length; a<n; a++){var s=t[a];i[a]=null!==s&&"object"==typeof s?e(s):s}else{var i=new t.constructor;for(var r in t)if(t.hasOwnProperty(r)){var s=t[r];i[r]=null!==s&&"object"==typeof s?e(s):s}}return i},i=$classesInjector.getAll(),a=function(e, a){if(void 0!==e&&void 0!==a&&i.hasOwnProperty(e)){a.init_functions=[];for(var n in i[e])"__dependencies__"!==n&&(i[e][n].constructor!==Function?(a[n]=t(i[e][n]),void 0!==a[n].__instance__&&(a[n].__instance__=a),void 0!==a[n]._init_&&a[n]._init_.constructor===Function&&a.init_functions.push(a[n]._init_),void 0!==a._init_&&a._init_.constructor===Function&&a.init_functions.push(a._init_)):(a[n]=i[e][n],"_init_"===n&&a.init_functions.push(a[n])))}};if(void 0!==e){if(e.hasOwnProperty("classes")&&e.classes.constructor===Array)for(var n in e.classes){var s=e.classes[n];a(s,this)}if(e.hasOwnProperty("base_class")&&i.hasOwnProperty(e.base_class)&&(this.__class__=e.base_class),e.hasOwnProperty("init"))for(var r in e.init)this.hasOwnProperty(r)&&(this[r].constructor===Field?this[r].value=e.init[r]:this[r]=e.init[r])}}return function(e){var t=new i(e);return t}}]);var injector=angular.injector(["ng","homunculus"]),factory=injector.get("$factory");angular.module("homunculus").factory("$navigation",["$log","$rootScope","$factory","$errors",function(e,t,i,a){var n=[],s=[],r=void 0;t.$on("$routeChangeStart",function(e, t, i){s=[];for(var a=n.length,l=0; l<a; l++){o.getById(n[l].parentId);if(n[l].url===t.$$route.originalPath){if(s.push(n[l]),void 0!==n[l].parentId&&""!==n[l].parentId)for(var d=n[l].parentId; void 0!==d&&""!==d;)for(var u=0; u<a; u++)n[u].id===d&&(s.unshift(n[u]),d=n[u].parentId);n[l].isActive=!0,r=n[l]}else n[l].isActive=!1}void 0!==r&&void 0!==r.onSelect&&"function"==typeof r.onSelect&&r.onSelect()});var o={getAll:function(){return n},getById:function(e){if(void 0===e&&""===e)return a.push(a.type.ERROR_TYPE_DEFAULT,"$navigation -> GetById: Не задан параметр - идентификатор раздела"),!1;for(var t=n.length,i=0; i<t; i++)if(n[i].id===e)return n[i];return!1},add:function(e){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$navigation -> add: Не задан объект с параметрами"),!1;if(void 0===e.id||""===e.id)return a.add(ERROR_TYPE_DEFAULT,"$navigation -> add: Не задан параметр - идентификатор раздела"),!1;if(void 0===e.url||""===e.url)return a.add(ERROR_TYPE_DEFAULT,"$navigation -> add: Не задан параметр - url раздела"),!1;var t=i({classes:["MenuItem"],base_class:"MenuItem"});t.id=e.id,t.parentId=void 0!==e.parentId?e.parentId:"",t.url=e.url,t.order=void 0!==e.order?e.order:0,t.icon=void 0!==e.icon?e.icon:"",t.title=void 0!==e.title?e.title:"",t.description=void 0!==e.description?e.description:"",t.isVisible=void 0===e.isVisible||e.isVisible,t.onSelect=void 0!==e.onSelect&&"function"==typeof e.onSelect?e.onSelect:void 0,n.push(t)},select:function(e, t){if(void 0===e)return a.push(a.type.ERROR_TYPE_DEFAULT,"$navigation -> select: Не задан параметр - идентификатор пути"),!1;for(var i=n.length,s=!1,r=0; r<i; r++)return n[r].id===e?(n[r].isActive=!0,s=!0,currentMenuItem=n[r],void 0!==t&&"function"==typeof t&&t(currentMenuItem)):n[r].isActive=!1,s}};return o}]),angular.module("homunculus").factory("$session",["$log","$http","$classes","$factory","$errors",function(e, t, i, a, n){var s=a({classes:["AppUser","Model","Backup","States"],base_class:"AppUser"});return{init:function(e){return void 0===e?(n.add(ERROR_TYPE_DEFAULT,"$session -> init: не задан парметр - источник данных"),!1):void(void 0!==e.user&&null!==e.user&&s._model_.fromJSON(e.user))},getCurrentUser:function(){return s},login:function(e,i,r){if(void 0===e)return n.add(ERROR_TYPE_DEFAULT,"$authorization -> login: Не задан параметр - логин пользователя"),!1;if(void 0===i)return n.add(ERROR_TYPE_DEFAULT,"$authorization -> login: Не задан параметр - пароль пользователя"),!1;var o={action:"login",data:{login:e,password:i}};t.post("/serverside/api.php",o).success(function(e){if(void 0!==e){if("false"!==e){var t=a({classes:["AppUser","Model","Backup","States"],base_class:"AppUser"});return t._model_.fromJSON(e),s._model_.fromJSON(e),void 0!==r&&"function"==typeof r&&r(s),!0}return void 0!==r&&"function"==typeof r&&r(!1),!0}return!1})},logout:function(e){if(0===s.id.value)return n.add(ERROR_TYPE_ENGINE,"$session -> logout: Пользователь не авторизован"),!1;var i={action:"logout",data:{userId:s.id.value}};t.post("/serverside/api.php",i).success(function(){return s.id.value=0,void 0!==e&&"function"==typeof e&&e(),!0}).error(function(){return!1})}}}]),angular.module("homunculus").factory("$settings",["$log","$http","$errors","$factory",function(e, t, i, a){var n={},s=!1;return api={init:function(e){if(void 0===e)return i.push(i.type.ERROR_TYPE_DEFAULT,"$settings -> init: Не задан параметр - источник данных"),!1;for(var t=e.length,s=0; s<t; s++){var r=a({classes:["Setting","Model","Backup","States"],base_class:"Setting"});r._model_.fromJSON(e[s]),r._onConstruct(),r._backup_.setup(),n[r.code.value]=r}},getAll:function(){return n},getByCode:function(e){if(void 0===e)return i.push(i.type.ERROR_TYPE_DEFAULT,"$settings -> getByCode: Не задан параметр - код настройки"),!1;for(var t in n)if(n[t].code.value===e)return n[t];return!1},save:function(e){var a={action:"saveSettings",data:{}};for(var s in n)a.data[s]=n[s].value.value;t.post("/serverside/api.php",a).then(function(t){if(void 0!==t.data&&"true"===t.data)return void 0!==e&&"function"==typeof e&&e(),!0},function(){return i.push(i.type.ERROR_TYPE_ENGINE,"$settings -> save: Не удалось сохранить значение настроек"),!1})},changed:function(e){return void 0!==e&&(s=e),s}}}]),angular.module("homunculus").factory("$users",["$log","$http","$errors","$classes","$factory",function(e, t, i, a, n){var s=[],r=void 0,o=n({classes:["AppUser","Model","Backup","States"],base_class:"AppUser"});return o._backup_.setup(),{users:{init:function(e){if(void 0===e)return i.add(ERROR_TYPE_DEFAULT,"$users -> init: Не задан параметр - источник данных"),!1;for(var t=e.length,a=0;a<t;a++){var r=n({classes:["AppUser","Model","Backup","States"],base_class:"AppUser"});r._model_.fromJSON(e[a]),r._backup_.setup(),s.push(r)}return!0},getAll:function(){return s},getCurrent:function(){return r},getNew:function(){return o},getById:function(a,o){if(void 0===a)return i.add(ERROR_TYPE_DEFAULT,"$users -> users -> getById: Не задан параметр - идентификатор пользователя"),!1;for(var l=s.length,d=0;d<l;d++)if(s[d].id.value===a)return e.info("getting user from cache"),r=s[d];var u={action:"getUserById",data:{id:a}};return t.post("/serverside/api.php",u).then(function(t){e.info("promise success");var i=n({classes:["AppUser","Model","Backup","States"],base_class:"AppUser"});return i._model_.fromJSON(t.data),i._backup_.setup(),r=i,void 0!==o&&"function"==typeof o&&o(r),r},function(){return!1})},select:function(e,t){if(void 0===e)return i.add(ERROR_TYPE_DEFAULT,"$users -> users -> select: Не задан параметр - идентификатор пользователя"),!1;for(var a=s.length,n=0;n<a;n++)if(s[n].id.value===e)return void 0!==t&&"function"==typeof t&&t(s[n]),s[n];return!1},add:function(e,i){var a={action:"addUser",data:{divisionId:o.divisionId.value,name:o.name.value,fname:o.fname.value,surname:o.surname.value,email:o.email.value,login:o.login.value,password:o.password.value,isAdministrator:o.isAdministrator.value===!0?1:0,allowEdit:o.allowEdit.value===!0?1:0,allowConfirm:o.allowConfirm.value===!0?1:0}};t.post("/serverside/api.php",a).success(function(t){if(void 0!==t){var i=n({classes:["AppUser","Model","Backup","States"],base_class:"AppUser"});return i._model_.fromJSON(t),i._backup_.setup(),s.push(i),o._backup_.restore(),void 0!==e&&"function"==typeof e&&e(i),!0}return!1}).error(function(e){return void 0!==i&&"function"==typeof i&&i(e),!1})},edit:function(e){if(void 0===r)return i.add("$users -> users -> edit: Текущий пользователь не выбран"),!1;var a={action:"editUser",data:{id:r.id.value,divisionId:r.divisionId.value,surname:r.surname.value,name:r.name.value,fname:r.fname.value,email:r.email.value,login:r.login.value,password:r.password.value,isAdministrator:r.isAdministrator.value===!0?1:0,allowEdit:r.allowEdit.value===!0?1:0,allowConfirm:r.allowConfirm.value===!0?1:0,isLDAPEnabled:r.isLDAPEnabled.value===!0?1:0}};r._states_.loading(!0),t.post("/serverside/api.php",a).success(function(t){if(r._states_.loading(!1),void 0!==t){var i=n({classes:["AppUser","Model","Backup","States"],base_class:"AppUser"});return i._model_.fromJSON(t),i._backup_.setup(),r=i,void 0!==e&&"function"==typeof e&&e(r),!0}return!1}).error(function(){return r._states_.loading(!1),!1})}},loadNextPage:function(e){({action:"loadUsers",data:{start:start}})},edit:function(e){if(void 0!==r){var i={action:"editUser",data:{id:r.id.value,divisionId:r.divisionId.value,name:r.name.value,fname:r.fname.value,surname:r.surname.value,email:r.email.value,isAdministrator:r.isAdministrator.value}};t.post("/serverside/api.php",i).success(function(t){if(void 0!==t)return r._backup_.setup(),r._states_.changed(!1),void 0!==e&&"function"==typeof e&&e(r),!0})}return!1}}}]),angular.module("homunculus").directive("uploader",["$log","$http","$errors",function(e,t,i){return{restrict:"A",scope:{uploaderData:"=",uploaderOnCompleteUpload:"=",uploaderOnBeforeUpload:"="},link:function(a,n,s){var r="",o=new FormData;return void 0===s.uploaderUrl||""===s.uploaderUrl?(i.add(ERROR_TYPE_DEFAULT,"uploader -> Не задан атрибут - url"),!1):(s.$observe("uploaderUrl",function(t){r=t,e.log("interpolated url = ",r)}),n.bind("change",function(){if(angular.forEach(n[0].files,function(t){e.log(t),o.append("file",t)}),e.log(a.uploaderOnBeforeUpload),void 0!==a.uploaderOnBeforeUpload&&"function"==typeof a.uploaderOnBeforeUpload&&a.$apply(a.uploaderOnBeforeUpload),void 0!==a.uploaderData){e.info(a.uploaderData);for(var t in a.uploaderData)o.append(t,a.uploaderData[t])}a.upload()}),void(a.upload=function(){e.info("upload, link = ",r),o.has("file")&&(n.prop("disabled","disabled"),t.post(r,o,{transformRequest:angular.identity,headers:{"Content-Type":void 0}}).success(function(t){e.log(t),n.prop("disabled",""),void 0!==a.uploaderOnCompleteUpload&&"function"==typeof a.uploaderOnCompleteUpload&&a.uploaderOnCompleteUpload(t),o.delete("file"),o=new FormData}))}))}}}]),angular.module("homunculus").filter("integer",["$errors",function(e){return function(e){if(void 0!==e)return"number"!=typeof e?"":Math.floor(e)}}]),angular.module("homunculus.ui",["homunculus"]),angular.module("homunculus.ui").factory("$dateTimePicker",["$log","$window","$document","$http","$compile","$rootScope","$errors","$factory",function(e,t,i,a,n,s,r,o){var l=[],d="",u=!1;return{push:function(e){if(void 0!==e){var t=o({classes:["DateTimePicker"],base_class:"DateTimePicker"});return t.id=e.settings.id,t.isModal=e.settings.isModal,t.isOpened=e.settings.isOpened,t.element=e.settings.element,t.scope=e,t.minDate=e.settings.minDate,t.maxDate=e.settings.maxDate,l.push(t),t}return r.add(ERROR_TYPE_DEFAULT,"krypton.ui -> dateTimePicker directive: Не задан параметр - объект с настройками директивы")},show:function(t){if(void 0===t)return r.add(ERROR_TYPE_DEFAULT,"krypton.ui -> dateTimePicker directive : Не задан параметр - идентификатор HTML_элемента");for(var i=l.length,a=0;a<i;a++)l[a].element.getAttribute("id")===t&&e.log("Element with id = "+t+" found!")},add:function(t){if(void 0!==t){if("object"==typeof t){if(void 0!==t.element){var i=document.getElementById(t.element);if(e.log("element = ",i),void 0!==i&&null!==i){var a=o({classes:["DateTimePicker"],base_class:"DateTimePicker"});a.id="dateTimePicker"+l.length,a.element=i,i.setAttribute("ui-date-time-picker","");for(var d in t)if(a.hasOwnProperty(d))switch(d){case"modelValue":a.modelValue=t[d];break;case"isModal":if("boolean"!=typeof t[d])return r.add(ERROR_TYPE_DEFAULT,"$dateTimePicker -> add: Неверно задан тип параметра - модальный режим");a.isModal=t[d];break;case"title":a.title=void 0!==t[d]&&""!==t[d]?t[d]:""}return l.push(a),e.log(l),e.info("dtp = ",a),n(a.element)(s.$new()),a}return r.add(ERROR_TYPE_DEFAULT,"$dateTimePicker -> add: Элемент с идентификатором '"+t[d]+"' не найден")}return r.add(ERROR_TYPE_DEFAULT,"$dateTimePicker -> add: Не задан целевой элемент")}return r.add(ERROR_TYPE_DEFAULT,"$dateTimePicker -> add: Неверно задан тип параметра инициализации")}return r.add(ERROR_TYPE_DEFAULT,"$dateTimePicker -> add: Не заданы параметры инициализации")},open:function(t){if(void 0===t)return r.add(ERROR_TYPE_DEFAULT,"$dateTimePicker -> open: Не задан параметр - идентификатор элемента");var i=l.length;e.log("instances defore",l);for(var a=0;a<i;a++){var n=!1;angular.element(l[a].element).prop("id")===t&&(n=!0,e.log("element with id = "+t+" found"),e.log(l[a]),l[a].scope.open()),n===!1&&e.log("Element "+t+" not found")}},exists:function(t){if(void 0!==t){e.log("elementId = ",t.toString());for(var i=l.length,a=0;a<i;a++)if(e.log("instance element = ",l[a].element.getAttribute("id")),l[a].element.getAttribute("id").toString()===t)return e.log("founded instance = ",l[a]),l[a];return!1}return r.add(ERROR_TYPE_DEFAULT,"$dateTimePicker -> exists: Не задан параметр - идентификатор элкмкнта")},getTemplate:function(){return d},setTemplate:function(e){return void 0===e?r.add(ERROR_TYPE_DEFAULT,"$dateTimePicker -> setTemplate: Не задан параметр - содержимое шаблона"):void(d=e)},loading:function(e){return void 0!==e?"boolean"==typeof e?u=e:r.add(ERROR_TYPE_DEFAULT,"$dateTimePicker -> loading: Неверно задан тип параметр - флаг процесса загрузки шаблона"):u},getAll:function(){return l},getById:function(e){if(void 0===e)return r.add(ERROR_TYPE_DEFAULT,"$dateTimePicker -> getById: Не задан параметр - идентификатор календаря"),!1;for(var t=l.length,i=0;i<t;i++)if(l[i].id===e)return l[i];return!1}}}]),angular.module("homunculus.ui").factory("$modals",["$log","$window","$compile","$errors",function(e,t,i,a){var n=[],s=function(e){if(void 0!==e){var i=t.innerWidth/2-angular.element(e).prop("clientWidth")/2+"px",a=t.innerHeight/2-angular.element(e).prop("clientHeight")/2+"px";angular.element(e).css("left",i),angular.element(e).css("top",a)}};return{getAll:function(){return n},getById:function(e){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$modals -> getById: Не задан параметр - идентификатор модального окна"),!1;for(var t=n.length,i=0;i<t;i++)if(n[i].id===e)return n[i];return!1},register:function(e){return void 0===e?(a.add(ERROR_TYPE_DEFAULT,"$modals -> register: Не задан парметр - объект модального окна"),!1):(n.push(e),!0)},open:function(e){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$modals -> open: Не задан параметр - идентификатор модального окна"),!1;for(var r=n.length,o=!1,l=0;l<r;l++)if(n[l].id===e){o=!0,currentModal=n[l];var d=document.getElementsByClassName("krypton-ui-modal")[0],u=document.getElementById("krypton-ui-modal-caption"),c=document.getElementById("krypton-ui-modal-content"),_=document.getElementById("krypton-ui-modal-footer");u.innerHTML=n[l].caption,c.innerHTML=n[l].content,void 0!==n[l].footer.content?(_.innerHTML=n[l].footer.content,angular.element(_).css("display","block"),0!==n[l].footer.height&&angular.element(_).css("height",n[l].footer.height+"px")):angular.element(_).css("display","none"),i(d)(n[l].scope),angular.element(d).css("display","block");var v=document.getElementsByClassName("krypton-ui-fog");document.body.style.overflow="hidden",v[0].classList.add("visible"),s(d),0!==n[l].width&&angular.element(d).css("width",n[l].width+"px"),0!==n[l].height?(angular.element(d).css("height",n[l].height+"px"),angular.element(c).css("height",n[l].height-35-n[l].footer.height+"px")):(angular.element(d).css("height","auto"),0!==n[l].footer.height?angular.element(c).css("height","auto"):angular.element(c).css("height","100%")),d.addEventListener("DOMSubtreeModified",function(){s(d)},!1),angular.element(t).bind("resize",function(){s(d)})}return o!==!1||(a.add(ERROR_TYPE_ENGINE,"$modals -> open: Модальное окно с идентификатором '"+e+"' не найдено"),!1)},close:function(){if(void 0!==currentModal){var e=document.getElementsByClassName("krypton-ui-modal")[0];void 0!==currentModal.onClose&&currentModal.onClose();var t=document.getElementsByClassName("krypton-ui-fog");return document.body.style.overflow="hidden",t[0].classList.remove("visible"),angular.element(e).css("display","none"),currentModal=void 0,!0}return!1}}}]),angular.module("homunculus.ui").factory("$tabs",["$log","$errors",function(e, t){var i=[];return{register:function(a){return void 0===a?(t.push(t.type.ERROR_TYPE_DEFAULT,"$tabs -> register: Не задан параметр - параметры регистрируемого компонента"),!1):(i.push(a),e.log("tabs",i),!0)},getById:function(e){if(void 0===e)return t.push(t.type.ERROR_TYPE_DEFAULT,"$tabs -> getById: Не задан параметр - идентификатор компонента"),!1;for(var a=i.length,n=0; n<a; n++)if(i[n].id===e)return i[n];return!1},select:function(e, i){return void 0===e?(t.push(t.type.ERROR_TYPE_DEFAULT,"$tabs -> select: Не задан параметр - идентификатор компонента"),!1):void 0===i?(t.push(t.type.ERROR_TYPE_DEFAULT,"$tabs -> select: Не задан параметр - идентификатор вкладки"),!1):void 0}}}]),angular.module("homunculus.ui").factory("$tree",["$log","$classes","$factory","$errors",function(e, t, i, a){var n=[],s={register:function(e){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$structure -> register: Не задан параметр - объект с настройками дерева"),!1;if(void 0===e.id||""===e.id)return a.add(ERROR_TYPE_DEFAULT,"$structure -> register: Не задан параметр дерева - идентификатор дерева"),!1;if(void 0===e.rootKey||""===e.rootKey)return a.add(ERROR_TYPE_DEFAULT,"$structure -> register: Не задан параметр дерева - значение ключа корневого элемента дерева"),!1;var t=i({classes:["TreeStructure"],base_class:"TreeStructure"});return t.id=e.id,t.rootKey=e.rootKey,t.expandOnSelect=void 0!==e.expandOnSelect,t.collapseOnDeselect=void 0!==e.collapseOnDeselect,t.onSelect=void 0!==e.onSelect&&"function"==typeof e.onSelect?e.onSelect:void 0,t.showNotifications=void 0===e.showNotifications||e.showNotifications,n.push(t),t},getById:function(e){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$structure -> getById: Не задан параметр - идентификатор дерева"),!1;for(var t=n.length,i=0;i<t;i++)if(n[i].id===e)return n[i];return!1},getItems:function(e){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$tree -> getItems: Не задан параметр - идентификатор дерева"),!1;var t=s.getById(e);return!!t&&t.stack},getItemByKey:function(e,t){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$structure -> getItemByKey: Не задан параметр - идентификатор дерева"),!1;if(void 0===t)return a.add(ERROR_TYPE_DEFAULT,"$structure -> getItemByKey: Не задан параметр - значение ключа элемента"),!1;var i=this.getById(e);if(!i)return a.add(ERROR_TYPE_DEFAULT,"$structure -> getItemByKey: Дерево с идентификатором '"+e+"' не найдено"),!1;var n=i.stack[t];return void 0!==n&&n},addItem:function(e){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$tree -> addItem: Не задан объект с параметрами"),!1;if(void 0===e.treeId)return a.add(ERROR_TYPE_DEFAULT,"$structure -> addItem: Не задан параметр - идентификатор дерева"),!1;if(void 0===e.key)return a.add(ERROR_TYPE_DEFAULT,"$structure -> addItem: Не задан параметр - значение ключа элемента"),!1;if(void 0===e.parentKey)return a.add(ERROR_TYPE_DEFAULT,"$structure -> addItem: Не задан параметр - значение родительского ключа элемента"),!1;if(void 0===e.display)return a.add(ERROR_TYPE_DEFAULT,"$structure -> addItem: Не задан параметр - отображаемое значение элемента"),!1;if(void 0!==e.order&&""===e.order)return a.add(ERROR_TYPE_DEFAULT,"$structure -> addItem: Не задан параметр - порядковый номер отображения элемента"),!1;var t=this.getById(e.treeId);if(!t)return a.add(ERROR_TYPE_DEFAULT,"$structure -> addItem: Дерево с идентификатором '"+e.treeId+"' не найдено"),!1;var n=i({classes:["TreeItem"],base_class:"TreeItem"});if(n.key=e.key,n.parentKey=e.parentKey,n.display=e.display,n.order=e.order,n.data=void 0!==e.data?e.data:{},n.parentKey===t.rootKey)t.initial[n.key]=n,t.onAddItem(n),t.stack[n.key]=n;else{var s=t.stack[n.parentKey];if(void 0===s)return a.add(ERROR_TYPE_DEFAULT,"$structure -> addItem: родительский элемент с ключом '"+e.parentKey+"' не найден"),!1;t.stack[n.key]=n,s.children[n.key]=n,s.childrenCount++,t.onAddItem(n),s.onAddChildren(n)}return n},expandItem:function(e,t){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$structure -> expandItem: Не задан параметр - идентификатор дерева"),!1;if(void 0===t)return a.add(ERROR_TYPE_DEFAULT,"$structure -> expandItem: Не задан параметр - значение ключа элемента"),!1;var i=this.getById(e);if(!i)return a.add(ERROR_TYPE_DEFAULT,"$structure -> expandItem: Дерево с идентификатором '"+e+"' не найдено"),!1;var n=i.stack[t];return void 0===n?(a.add(ERROR_TYPE_ENGINE,"$structure -> expandItem: Элемент с ключом "+t+" не найден"),!1):(n.childrenCount>0&&(n.isExpanded=!0),!0)},expandToRoot:function(e,t){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$structure -> expandToRoot: Не задан параметр - идентификатор дерева"),!1;if(void 0===t)return a.add(ERROR_TYPE_DEFAULT,"$structure -> expandToRoot: Не задан параметр - значение ключа элемента"),!1;var i=this.getById(e);if(!i)return a.add(ERROR_TYPE_DEFAULT,"$structure -> expandToRoot: Дерево с идентификатором '"+e+"' не найдено"),!1;var n=i.stack[t];if(void 0===n)return a.add(ERROR_TYPE_ENGINE,"$structure -> expandToRoot: Элемент с ключом "+t+" не найден"),!1;for(var s=i.stack[n.parentKey];s;)s.isExpanded=!0,s=i.stack[s.parentKey]},collapseItem:function(e,t){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$structure -> collapseItem: Не задан параметр - идентификатор дерева"),!1;if(void 0===t)return a.add(ERROR_TYPE_DEFAULT,"$structure -> collapseItem: Не задан параметр - значение ключа элемента"),!1;var i=this.getById(e);if(!i)return a.add(ERROR_TYPE_DEFAULT,"$structure -> collapseItem: Дерево с идентификатором '"+e+"' не найдено"),!1;var n=i.stack[t];return void 0===n?(a.add(ERROR_TYPE_ENGINE,"$structure -> collapseItem: Элемент с ключом "+t+" не найден"),!1):(n.isExpanded=!1,!0)},selectItem:function(e,t){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$structure -> selectItem: Не задан параметр - идентификатор дерева"),!1;if(void 0===t)return a.add(ERROR_TYPE_DEFAULT,"$structure -> selectItem: Не задан параметр - значение ключа элемента"),!1;var i=this.getById(e);if(!i)return a.add(ERROR_TYPE_DEFAULT,"$structure -> selectItem: Дерево с идентификатором '"+e+"' не найдено"),!1;var n=i.stack[t];if(void 0===n)return a.add(ERROR_TYPE_ENGINE,"$structure -> selectItem: Элемент с ключом "+t+" не найден"),!1;for(var s in i.stack){var r=i.stack[s];r.key===t?(r.isSelected===!0?(r.isSelected=!1,i.selectedItem=!1,i.collapseOnDeselect===!0&&(r.isExpanded=!1)):(r.isSelected=!0,i.selectedItem=r,i.expandOnSelect===!0&&r.childrenCount>0&&(r.isExpanded=!0)),i.onSelect(r)):r.isSelected=!1}return!0},isChildrenOf:function(e,t,i){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$tree -> isChildrenOf: Не задан параметр - идентификатор дерева"),!1;if(void 0===t)return a.add(ERROR_TYPE_DEFAULT,"$tree -> isChildrenOf: Не задан параметр - значение ключа элемента"),!1;var n=this.getById(e);if(!n)return a.add(ERROR_TYPE_DEFAULT,"$tree -> isChildrenOf: Дерево с идентификатором '"+e+"' не найдено"),!1;var s=n.stack[t];if(void 0===s)return a.add(ERROR_TYPE_ENGINE,"$tree -> isChildrenOf: Элемент с ключом "+t+" не найден"),!1;var r=n.stack[i];if(void 0===r)return a.add(ERROR_TYPE_ENGINE,"$tree -> isChildrenOf: родительсктй элемент с ключом "+i+" не найден"),!1;for(var r=s;r;)r=n.stack[r.parentKey]},calcViolations:function(e,t){if(void 0===e)return a.add(ERROR_TYPE_DEFAULT,"$structure -> calc: Не задан параметр - идентификатор дерева"),!1;if(void 0===t)return a.add(ERROR_TYPE_DEFAULT,"$structure -> calc: Не задан параметр - значение ключа элемента"),!1;var i=this.getById(e);if(!i)return a.add(ERROR_TYPE_DEFAULT,"$structure -> calc: Дерево с идентификатором '"+e+"' не найдено"),!1;var n=i.stack[t];if(void 0===n)return a.add(ERROR_TYPE_ENGINE,"$structure -> calc: Элемент с ключом "+t+" не найден"),!1;var s=0;for(var r in n.children){var o=n.children[r];s+=o.data.violationsAdded}return s}};return s}]),angular.module("homunculus.ui").directive("uiDateTimePicker",["$log","$compile","$window","$document","$errors","$dateTimePicker",function(e,t,i,a,n,s){return{restrict:"A",require:"ngModel",priority:10,scope:{ngModel:"=",dateTimePickerModal:"=",dateTimePickerEnableTime:"=",dateTimePickerEnableMinutes:"=",dateTimePickerThroughNavigation:"=",dateTimePickerNoValue:"@",dateTimePickerOnSelect:"=",dateTimePickerMinDate:"=",dateTimePickerMaxDate:"=",dateTimePickerFormat:"@"},link:function(r,o,l,d){var u="<div class='toolbar'><div class='control'><button class='width-100 blue' ng-class='{ \"very-big\": settings.isModal === true }' ng-click='prev()'>&larr;</button></div><div class='content'><select class='width-60 no-border' ng-if='isInTimeSelectMode === false' ng-model='month' ng-options='month[0] as month[1] for month in months'></select><select class='width-40 no-border' ng-if='isInTimeSelectMode === false' ng-model='year' ng-options='year as year for year in years'></select><span class='selected-date width-100' ng-if='isInTimeSelectMode === true && isInMinutesSelectMode === false && settings.isModal === false'>{{ value.format('DD.MM.YYYY, HH ч.') }}</span><span class='selected-date width-100' ng-if='isInTimeSelectMode === true && isInMinutesSelectMode === false && settings.isModal === true'>{{ value.format('DD MMM YYYY, HH ч.') }}</span><span class='selected-date width-100' ng-if='isInTimeSelectMode === true && isInMinutesSelectMode === true && settings.isModal === false'>{{ value.format('DD.MM.YYYY, HH:mm') }}</span><span class='selected-date width-100' ng-if='isInTimeSelectMode === true && isInMinutesSelectMode === true && settings.isModal === true'>{{ value.format('DD MMM YYYY, HH:mm') }}</span></div><div class='control'><button class='width-100 blue' ng-class='{ \"very-big\": settings.isModal === true }' ng-click='next()'>&rarr;</button></div></div><div class='weekdays'><div class='day width-100' ng-if='isInTimeSelectMode === true && isInMinutesSelectMode === false'>часы</div><div class='day width-100' ng-if='isInTimeSelectMode === true && isInMinutesSelectMode === true'>минуты</div><div class='day' ng-if='isInTimeSelectMode === false' ng-repeat='weekday in weekdays track by $index'><span ng-if='settings.isModal === true'>{{ weekday[1] }}</span><span ng-if='settings.isModal === false'>{{ weekday[0] }}</span></div></div><div class='days-container' style='height:{{ height + \"px\" }}; max-height:{{ height }};'><div class='day' ng-if='isInTimeSelectMode === false' ng-class='{\"sunday\": ($index + 1) % 7 === 0, \"not-this-month\": day.month() !== month, \"current\": day.date() === now.date() && day.month() === value.month(), \"disabled\": day.unix() < settings.minDate || day.unix() > settings.maxDate }' ng-repeat='day in days track by $index' ng-click='select(day.unix())'>{{ day.date() }}</div><div style='line-height: {{ height / 4 + \"px\" }};' class='hour' ng-if='isInTimeSelectMode === true && isInMinutesSelectMode === false' ng-class='{\"current\": value.hours() === $index}' ng-repeat='hour in hours track by $index' ng-click='select($index)'>{{ hour }}</div><div style='line-height: {{ height / 3 + \"px\" }};' class='minute' ng-if='isInTimeSelectMode === true && isInMinutesSelectMode === true' ng-class='{\"current\": value.minutes() === ($index * 5)}' ng-repeat='minute in minutes track by $index' ng-click='select(minute)'>{{ minute }}</div></div>";
if(void 0===l.dateTimePickerId)return n.add(ERROR_TYPE_DEFAULT,"date-time-picker: Не задан идентификатор календаря"),!1;for(var c=(r.height=0,r.calendarHeight=0,r.ctrl=d,r.days=[]),_=(r.weekdays=[["Пн","Понедельник"],["Вт","Вторник"],["Ср","Среда"],["Чт","Четверг"],["Пт","Пятница"],["Сб","Суббота"],["Вс","Воскресение"]],r.months=[[0,"Январь"],[1,"Февраль"],[2,"Март"],[3,"Апрель"],[4,"Май"],[5,"Июнь"],[6,"Июль"],[7,"Август"],[8,"Сентябрь"],[9,"Октябрь"],[10,"Ноябрь"],[11,"Декабрь"]],r.hours=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],r.minutes=["00","05","10","15","20","25","30","35","40","45","50","55"],r.now=moment(new Date)),v=r.date=moment(_),p=r.value=moment(_),f=(r.day=p.date(),r.month=v.month(),r.year=moment(p).year(),r.years=[]),m=moment(p).year()-5;m<moment(p).year()+5;m++)f.push(m),m===moment(p).year()&&(selectedYear=m);var h=(r.isInTimeSelectMode=!1,r.isInMinutesSelectMode=!1,r.settings={id:l.dateTimePickerId,isModal:null!==r.dateTimePickerModal&&void 0!==r.dateTimePickerModal,isOpened:!1,isTimeEnabled:null!==r.dateTimePickerEnableTime&&void 0!==r.dateTimePickerEnableTime,isTroughNavigationEnabled:null!==r.dateTimePickerThroughNavigation&&void 0!==r.dateTimePickerThroughNavigation,title:"",noValue:null!==r.dateTimePickerNoValue&&void 0!==r.dateTimePickerNoValue&&""!==r.dateTimePickerNoValue?r.dateTimePickerNoValue:void 0,element:o,onSelect:null!==r.dateTimePickerOnSelect&&void 0!==r.dateTimePickerOnSelect?r.dateTimePickerOnSelect:void 0,minDate:null!==r.dateTimePickerMinDate&&void 0!==r.dateTimePickerMinDate?r.dateTimePickerMinDate:0,maxDate:null!==r.dateTimePickerMaxDate&&void 0!==r.dateTimePickerMaxDate?r.dateTimePickerMaxDate:Number.POSITIVE_INFINITY,format:null!==r.dateTimePickerFormat&&void 0!==r.dateTimePickerFormat&&""!==r.dateTimePickerFormat?r.dateTimePickerFormat:"DD MMM YYYY"},function(e){if(void 0===e)return n.add(ERROR_TYPE_DEFAULT,"krypton.ui -> dateTimePicker directive: Не задан параметр - порядковый номер месяца");var t=moment(e+"-"+r.year,"MM-YYYY").daysInMonth(),i=moment("01."+e+"."+r.year,"DD.MM.YYYY").weekday(),a=moment(t+"."+e+"."+r.year,"DD.MM.YYYY").weekday(),s="";if(c.splice(0,c.length),i>0)for(var o=moment("01."+e+"."+r.year+" 00:00","DD.MM.YYYY HH:mm").subtract(i,"days"),l=0;l<i;l++){var d=moment(o).add(l,"days");c.push(d)}for(var u=1;u<=t;u++){var d=moment(u+"."+e+"."+r.year+" 00:00","DD.MM.YYYY HH:mm");c.push(d),moment(d).date()===t&&(s=d)}if(a<6)for(var o=moment(s).add(1,"days"),u=1;u<=6-a;u++){var d=moment(s).add(u,"days");c.push(d)}}),E=function(e){if(void 0!==e){for(var t=angular.element(o).prop("clientWidth"),a=angular.element(o).prop("clientHeight"),s=angular.element(o).prop("offsetLeft"),l=angular.element(o).prop("offsetTop"),d=angular.element(e).prop("clientWidth"),u=angular.element(e).prop("clientHeight"),c=0,_=0,v=i.innerWidth,p=i.innerHeight,f=0,m=0,h=o[0].offsetParent;h;)_+=h.scrollLeft,c+=h.scrollTop,h=h.offsetParent;return r.settings.isModal===!0?(f=v/2-angular.element(e).prop("clientWidth")/2+"px",m=p/2-angular.element(e).prop("clientHeight")/2+"px"):(d>t?s>(d-t)/2&&s<v-s+d/2&&(f=s-(d-t)/2):f=angular.element(o).prop("offsetLeft")+"px",m=l-u+10<0?l+a+10+"px":angular.element(e).prop("clientHeight")+c-10+"px"),angular.element(e).css("left",f),angular.element(e).css("top",m),r.isInTimeSelectMode===!0?r.height=r.calendarHeight:(r.height="auto",r.calendarHeight=r.settings.isModal===!0?u-80:u-55),!0}return n.add(ERROR_TYPE_DEFAULT,"krypton.ui -> dateTimePicker directive: Не задан параметр - HTML-элемент")};d.$parsers.push(function(e){return r.$apply(),e}),d.$formatters.push(function(e){return 0===e?void 0!==r.settings.noValue?r.settings.noValue:moment.unix(e).format("DD MMM YYYY"):r.settings.isTimeEnabled===!0?moment.unix(e).format("DD MMM YYYY, HH:mm"):moment.unix(e).format(r.settings.format)}),r.prev=function(){r.settings.isTimeEnabled===!0&&r.isInTimeSelectMode===!0?r.isInMinutesSelectMode===!1?r.settings.isTroughNavigationEnabled===!1?r.value.hours()>0&&r.value.hours()<=23?r.value.subtract(1,"hours"):0===r.value.hours()&&r.value.hours(23):r.value.subtract(1,"hours"):r.settings.isTroughNavigationEnabled===!1?r.value.minutes()>0&&r.value.minutes()<=59?r.value.subtract(5,"minutes"):0===r.value.minutes()&&r.value.minutes(55):r.value.subtract(5,"minutes"):(r.date.subtract(1,"months"),r.month=r.date.month(),r.year=r.date.year(),h(r.date.month()+1))},r.next=function(){r.settings.isTimeEnabled===!0&&r.isInTimeSelectMode===!0?r.isInMinutesSelectMode===!1&&r.settings.isTroughNavigationEnabled===!1?r.value.hours()>=0&&r.value.hours()<23?r.value.add(1,"hours"):23===r.value.hours()&&r.value.hours(0):r.value.add(5,"minutes"):(r.date.add(1,"months"),moment(r.date).day(1),r.month=moment(r.date).month(),r.year=moment(r.date).year(),h(r.date.month()+1))},r.select=function(t){if(void 0!==t){if(t>=r.settings.minDate&&t<=r.settings.maxDate){if(r.settings.isTimeEnabled===!0)if(r.isInTimeSelectMode===!1){var i=moment.unix(t).hours(0).minutes(0).seconds(0);r.month=i.month(),r.day=i.date(),r.value.month(r.month).date(r.day).hours(0).minutes(0).seconds(0),d.$setViewValue(r.value.unix()),r.isInTimeSelectMode=!0}else r.isInMinutesSelectMode===!1?(r.value.hours(t).minutes(0).seconds(0),d.$setViewValue(r.value.unix()),r.isInMinutesSelectMode=!0):(r.value.minutes(parseInt(t)),d.$setViewValue(r.value.unix()),r.close());else{var i=moment.unix(t).hours(0).minutes(0).seconds(0);r.month=i.month(),r.day=i.date(),r.value.month(r.month).date(r.day).hours(0).minutes(0).seconds(0),r.ngModel=r.value.unix(),d.$setViewValue(r.value.unix()),r.value=moment(new Date),r.close()}void 0!==r.settings.onSelect&&r.settings.onSelect(r.value.unix())}}else e.error("value = ",t)};var T=s.push(r),g=document.createElement("div");if(g.setAttribute("id",T.id),g.className="ui-date-time-picker2",r.settings.isModal===!0){g.classList.add("modal");var R=document.getElementsByClassName("krypton-ui-fog");if(0===R.length){var A=document.createElement("div");A.className="krypton-ui-fog",document.body.appendChild(A)}}g.innerHTML=u,document.body.appendChild(g),t(g)(r),angular.element(o).css("cursor","pointer"),h(r.date.month()+1),r.open=function(){if(r.settings.isModal===!0){var e=document.getElementsByClassName("krypton-ui-fog");document.body.style.overflow="hidden",e[0].classList.add("visible")}angular.element(g).css("display","block"),r.settings.isOpened=!0,E(g)},r.close=function(){if(r.settings.isModal===!0){var e=document.getElementsByClassName("krypton-ui-fog");e[0].classList.remove("visible"),document.body.style.overflow="auto"}angular.element(g).css("display","none"),r.settings.isOpened=!1,r.isInMinutesSelectMode=!1,r.isInTimeSelectMode=!1,r.value=new moment(new Date)},g.addEventListener("DOMSubtreeModified",function(){E(g)},!1),angular.element(i).bind("resize",function(){E(g)}),angular.element(a).bind("mousedown",function(e){r.settings.isOpened===!0&&g.contains(e.target)===!1&&e.target!==o[0]&&r.close()}),o.on("mousedown",function(){r.settings.isOpened===!1&&r.open()}),o.on("keydown",function(e){e.preventDefault()}),angular.element(angular.element(o).parent()).on("scroll",function(){E(g)})}}}]),angular.module("homunculus.ui").directive("uiModalFooter",["$log","$sce","$modals",function(e,t,i){return{restrict:"E",require:"^uiModal",link:function(i,a,n,s){var r=0;void 0!==n.height&&""!==n.height&&(r=parseInt(n.height)),e.log("ui modal footer"),s.registerFooter(t.trustAsHtml(a[0].innerHTML),r),angular.element(a).remove()}}}]),angular.module("homunculus.ui").directive("uiModal",["$log","$sce","$modals",function(e,t,i){return{restrict:"A",scope:!1,controller:function(e,t){e.footer={content:void 0,height:0};this.registerFooter=function(t,i){e.footer.content=t,e.footer.height=i}},link:function(e,a,n,s){if(void 0===n.modalId)return $errors.add(ERROR_TYPE_DEFAULT,"krypton.ui -> modal: Не задан идентификатор модального окна - аттрибут 'modal-id'"),!1;var r={id:n.modalId,isVisible:!1,caption:void 0!==n.modalCaption?n.modalCaption:"",content:t.trustAsHtml(a[0].innerHTML),footer:e.footer,scope:e,width:void 0===n.modalWidth||isNaN(n.modalWidth)?0:parseInt(n.modalWidth),height:void 0===n.modalHeight||isNaN(n.modalHeight)?0:parseInt(n.modalHeight),onClose:void 0!==n.modalOnClose&&"function"==typeof e.$eval(n.modalOnClose)?e.$eval(n.modalOnClose):void 0,onOpen:void 0!==n.modalOnOpen&&"function"==typeof e.$eval(n.modalOnOpen)?e.$eval(n.modalOnOpen):void 0};a[0].innerHTML="",a[0].classList.add("ng-hide"),i.register(r);var o=document.getElementsByClassName("krypton-ui-modal");if(0===o.length){var r=document.createElement("div");r.className="krypton-ui-modal";var l=document.createElement("div");l.className="modal-header";var d=document.createElement("span");d.setAttribute("id","krypton-ui-modal-caption"),d.className="modal-caption";var u=document.createElement("span");u.className="modal-close fa fa-times right",u.setAttribute("title","Закрыть"),u.setAttribute("ng-click","modals.close()"),l.appendChild(d),l.appendChild(u);var c=document.createElement("div");c.setAttribute("id","krypton-ui-modal-content"),c.className="modal-content";var _=document.createElement("div");_.setAttribute("id","krypton-ui-modal-footer"),_.className="modal-footer",document.body.appendChild(r),r.appendChild(l),r.appendChild(c),r.appendChild(_)}var v=document.getElementsByClassName("krypton-ui-fog");if(0===v.length){var p=document.createElement("div");p.className="krypton-ui-fog",document.body.appendChild(p)}}}}]),angular.module("homunculus.ui").directive("uiTab",["$log","$templateCache","$errors",function(e,t,i){return{restrict:"E",require:"^uiTabs",link:function(a,n,s,r){if(e.log("tab directive"),void 0===s.id||""===s.id)return i.push(i.type.ERROR_TYPE_DEFAULT,"ui-tab -> Не задан аттрибут - идентификатор вкладки"),!1;var o=a.settings={id:s.id,caption:void 0!==s.caption&&""!==s.caption?s.caption:"",icon:void 0!==s.icon&&""!==s.icon?s.icon:void 0,title:void 0!==s.title&&""!==s.title?s.title:"",content:n[0].innerHTML,isActive:!1};t.put("ui-tabs-"+r.getId()+"-"+o.id,o.content),r.registerTab(o),n[0].innerHTML=""}}}]),angular.module("homunculus.ui").directive("uiTabs",["$log","$templateCache","$errors","$tabs",function(e, t, i, a){return{restrict:"E",transclude:!0,scope:{onTabSelect:"="},replace:!0,template:"<div class='ui-tabs'><div ng-transclude></div><div class='tabs-container'><div class='ui-tab' ng-class='{ active: tab.isActive === true }' ng-repeat='tab in settings.tabs' ng-click='selectTab(tab.id)' title='{{ tab.title }}'><span class='fa {{ tab.icon }}' ng-show='tab.icon !== undefined'></span><span class='tab-caption'>{{ tab.caption }}</div></div><div class='tabs-content' id='tabs-content-{{settings.id}}' ><div ng-include='templateId' onload='onLoad()'></div></div></div>",controller:function(t, n, s){if(void 0===s.id||""===s.id)return i.push(i.type.ERROR_TYPE_DEFAULT,"ui-tabs -> Не задан аттрибут - идентификатор компонента"),!1;var r=t.settings={id:s.id,tabs:[],content:"",onTabSelect:void 0!==t.onTabSelect&&"function"==typeof t.onTabSelect?t.onTabSelect:void 0};t.templateId="ui-tabs-"+r.id;t.onLoad=function(){e.info("template loaded")};var o=a.getById(r.id);o||a.register(r),this.getId=function(){return r.id},this.registerTab=function(e){if(void 0===e)return i.push(i.type.ERROR_TYPE_DEFAULT,"ui-tabs -> registerTab: Не задан параметр - объект с настройками вкладки"),!1;for(var a=r.tabs.length,n=0; n<a; n++){if(r.tabs[n].id===e.id)return i.push(i.type.ERROR_TYPE_ENGINE,"ui-tabs -> registerTab: Вкладка с идентификатором '"+e.id+"' уже существует"),!1;r.tabs[n].isActive=!1}return r.tabs.push(e),r.tabs[0].isActive=!0,t.templateId="ui-tabs-"+r.id+"-"+r.tabs[0].id,!0},this.selectTab=t.selectTab=function(e){if(void 0===e)return i.push(i.type.ERROR_TYPE_DEFAULT,"ui-tabs -> selectTab: Не задан параметр - идентифкатор вкладки"),!1;for(var a=r.tabs.length,n=0; n<a; n++)r.tabs[n].id===e?(r.tabs[n].isActive=!0,t.templateId="ui-tabs-"+r.id+"-"+r.tabs[n].id):r.tabs[n].isActive=!1;return!0}},link:function(t, i, a, n){e.log("tabs directive")}}}]),angular.module("homunculus.ui").directive("uiTimePicker",["$log",function(e){return{restrict:"E",require:"ngModel",priority:10,scope:{ngModel:"=",class:"@"},replace:!0,template:"<div class='ui-time-picker {{ class }}'><div class='time-picker-hours'><input type='text' maxlength='2' value='{{ hours }}'></div><div class='time-picker-separator'>:</div><div class='time-picker-minutes'><input type='text' maxlength='2' value='{{ minutes }}'></div></div>",link:function(t,i,a,n){var s=0,r=(t.hours="00",t.minutes="00",0),o=0,l=angular.element(i.children()[0]).children()[0],d=angular.element(i.children()[2]).children()[0];e.log("hrs = ",l),e.log("mns = ",d),t.$watch("ngModel",function(t){e.log("time model = ",t)}),n.$formatters.push(function(i){return s=moment.unix(i),e.log("filter date = ",s.format("DD.MM.YYYY HH:mm")),t.hours=moment.unix(i).format("HH"),t.minutes=moment.unix(i).format("mm"),moment.unix(i).format("HH:mm")}),n.$parsers.push(function(t){return e.log("parser val = ",t),t}),angular.element(l).on("keydown",function(t){r=angular.element(l).val(),e.log("previousHours = ",r)}),angular.element(l).on("keyup",function(){var i=new RegExp("^([0-9]|0[0-9]|1[0-9]|2[0-3])$");i.test(angular.element(l).val())?(e.log("hours accepted"),s.hours(parseInt(angular.element(l).val())),n.$setViewValue(s.unix()),e.info(n),t.$apply()):e.log("shit")}),angular.element(d).on("keydown",function(t){o=angular.element(d).val(),e.log("previousMinutes = ",o)}),angular.element(d).on("keyup",function(){var t=new RegExp("^(0|[0-5]?[0-9])$");t.test(angular.element(d).val())?(e.log("minutes accepted"),s.minutes(parseInt(angular.element(d).val())),n.$setViewValue(s.unix()),angular.element(d).val(moment.unix(s).format("mm")),e.info(n)):(e.log("shit"),angular.element(d).val(o))})}}}]),angular.module("homunculus.ui").directive("uiTree",["$log","$templateCache","$errors","$tree",function(e,t,i,a){var n="<div class='container nested'><div class=\"tree-item\" ng-show='node.isVisible !== false' ng-class='{ \"with-children\": node.childrenCount > 0, \"expanded\": node.isExpanded === true && node.childrenCount > 0, \"active\": node.isSelected === true }' ng-repeat=\"node in node.children | toArray | orderBy: 'order' track by $index\"><div class='tree-item-content' ng-click='expand(node)'><div class='item-label' ng-class='{ \"active\": node.isSelected === true }' ng-click='select(node, $event)'><span>{{ node.display }}</span></div><div class='item-controls'><span class='expand fa fa-chevron-down' ng-click='expand(node)' ng-show='node.childrenCount > 0 && node.isExpanded == false'></span><span class='collapse fa fa-chevron-up' ng-if='node.isExpanded === true' ng-click='collapse(node)'></span></div><div class='item-notifications' ng-show='tree.showNotifications == true && node.notifications.items.length > 0'><div class='notification {{ notification.class }}' ng-repeat='notification in node.notifications.items track by $index' ng-show='notification.isVisible === true'><span class='fa {{ notification.icon }} notification.class' ng-show='notification.icon !== \"\"'></span><span class='value'>{{ notification.value }}</span></div></div></div><div ng-show='node.isExpanded === true' ng-include=\"'tree'\"></div></div></div>";return{restrict:"E",scope:{class:"@"},template:"<div class='{{ \"krypton-ui-tree \" + class }}'><div class='container root'><div class='tree-item' ng-show='node.isVisible !== false' ng-class='{ \"with-children\": node.childrenCount > 0, \"expanded\": node.isExpanded === true, \"active\": node.isSelected === true }' ng-repeat='node in initial | toArray | orderBy:\"order\" track by $index'><div class='tree-item-content' ng-click='expand(node)'><div class='item-label' ng-class='{ active: node.isSelected === true }' ng-click='select(node, $event)'><span>{{ node.display }}</span></div><div class='item-controls'><span class='expand fa fa-chevron-down' ng-click='expand(node)' ng-show='node.childrenCount > 0 && node.isExpanded === false'></span><span class='collapse fa fa-chevron-up' ng-if='node.isExpanded === true' ng-click='collapse(node)'></span></div><div class='item-notifications' ng-show='tree.showNotifications === true && node.notifications.items.length > 0'><div class='notification {{ notification.class }}' ng-repeat='notification in node.notifications.items track by $index' ng-show='notification.isVisible === true'><span class='fa {{ notification.icon }}' ng-show='notification.icon !== \"\"'></span><span class='value'>{{ notification.value }}</span></div></div></div><div ng-include=\"'tree'\" ng-show='node.isExpanded === true'></div></div></div></div>",link:function(s,r,o){if(void 0===o.id||""===o.id)return i.add(ERROR_TYPE_ENGINE,"structure directive -> Не задан параметр - идентификатор дерева"),!1;if(void 0===o.rootKey||""===o.rootKey)return i.add(ERROR_TYPE_ENGINE,"structure directive -> Не задан параметр - значение коюча корневого элемента дерева"),!1;if(void 0===o.rootKeyDataType||""===o.rootKeyDataType)return i.add(ERROR_TYPE_ENGINE,"structure directive -> Не задан параметр - тип данных коюча корневого элемента дерева"),!1;var l=0;switch(o.rootKeyDataType){case"DATA_TYPE_INTEGER":if(isNaN(parseInt(o.rootKey)))return i.add(ERROR_TYPE_ENGINE,"structure directive -> Значение ключа корневого элемента не соответствует типу данных коючевого элемента"),!1;l=parseInt(o.rootKey);break;case"DATA_TYPE_FLOAT":if(isNaN(parseFloat(o.rootKey)))return i.add(ERROR_TYPE_ENGINE,"structure directive -> Значение ключа корневого элемента не соответствует типу данных коючевого элемента"),!1;l=parseFloat(o.rootKey);break;case"DATA_TYPE_STRING":l=o.rootKey.toString();break;default:return i.add(ERROR_TYPE_ENGINE,"structure directive -> Неверно задан тип данных корневого элемента"),!1}s.initial={},s.stack={};t.put("tree",n);var d=a.getById(o.id);d!==!1?(s.initial=d.initial,s.stack=d.stack,s.tree=d):(a.register({id:o.id,rootKey:l,expandOnSelect:void 0!==o.expandOnSelect,collapseOnDeselect:void 0!==o.collapseOnDeselect}),s.tree=a.getById(o.id)),s.select=function(e,t){if(t.stopPropagation(),void 0!==e)return!!a.selectItem(o.id,e.key)||(i.add(ERROR_TYPE_ENGINE,"structure directive -> '"+o.id+"' select: Не удалось выбрать элемент с идентификатором "+e.key),!1)},s.expand=function(t){if(void 0!==t){if(e.log(t),0==t.isExpanded){if(!a.expandItem(o.id,t.key))return i.add(ERROR_TYPE_ENGINE,"structure directive -> expand: не удвлось развернуть элемент с идентификатором "+t.key),!1}else if(!a.collapseItem(o.id,t.key))return i.add(ERROR_TYPE_ENGINE,"structure directive -> expand: Не удалось свернуть элемент с идентификатором "+t.key),!1;return!0}}}}}]),$classesInjector.add("AppUser",{id:new Field({source:"ID",type:DATA_TYPE_INTEGER,value:0,default_value:0}),divisionId:new Field({source:"DIVISION_ID",type:DATA_TYPE_INTEGER,value:0,default_value:0,backupable:!0}),surname:new Field({source:"SURNAME",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),name:new Field({source:"NAME",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),fname:new Field({source:"FNAME",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),email:new Field({source:"EMAIL",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),login:new Field({source:"LOGIN",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),password:new Field({source:"PASSWORD",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),isAdministrator:new Field({source:"IS_ADMINISTRATOR",type:DATA_TYPE_BOOLEAN,value:!1,default_value:!1,backupable:!0}),allowEdit:new Field({source:"ALLOW_EDIT",type:DATA_TYPE_BOOLEAN,value:!1,default_value:!1,backupable:!0}),allowConfirm:new Field({source:"ALLOW_CONFIRM",type:DATA_TYPE_BOOLEAN,value:!1,default_value:!1,backupable:!0}),isLDAPEnabled:new Field({source:"IS_LDAP_ENABLED",type:DATA_TYPE_BOOLEAN,value:!1,default_value:!1,backupable:!0})}),$classesInjector.add("Backup",{__dependencies__:[],_backup_:{__instance__:"",data:{},setup:function(){var e=0;for(var t in this.__instance__)if(this.__instance__[t].constructor===Field&&void 0!==this.__instance__[t].backupable&&this.__instance__[t].backupable===!0&&null!==this.__instance__[t])if(void 0!==this.__instance__[t].type)switch(parseInt(this.__instance__[t].type)){case DATA_TYPE_STRING:this.data[t]=this.__instance__[t].value.toString();break;case DATA_TYPE_INTEGER:this.data[t]=parseInt(this.__instance__[t].value);break;case DATA_TYPE_FLOAT:this.data[t]=+parseFloat(this.__instance__[t].value).toFixed(6);break;case DATA_TYPE_BOOLEAN:this.data[t]=this.__instance__[t].value}else this.data[t]=this.__instance__[t].value,e++;return void 0!==this.__instance__._init_&&this.__instance__._init_(),e},restore:function(){var e=0;for(var t in this.data)void 0!==this.__instance__[t]&&this.__instance__[t].constructor===Field&&this.__instance__[t].backupable===!0&&(this.__instance__[t].value=this.data[t],e++);return void 0!==this.__instance__.onInitModel&&this.__instance__.onInitModel(),void 0!==this.__instance__.onRestoreBackup&&this.__instance__.onRestoreBackup(),e},toString:function(){return JSON.stringify(this.data)}}}),$classesInjector.add("Collection",{items:[],selectedItems:[],allowMultipleSelect:!1,allowMultipleSearch:!1,size:function(){return this.items.length},display:function(){var e=this.items.length;return void 0!==console&&console.log(this.items),e},multipleSearch:function(e){var t=!1;return void 0!==e?e.constructor===Boolean?(this.allowMultipleSearch=e,t=this.allowMultipleSearch):$log.error("$classes 'Collection': Параметр должен быть типа Boolean"):$log.error("$classes 'Collection': Не указан параметр при установке режима поиска нескольких элементов"),t},find:function(e,t){var i=!1,a=[],n=this.items.length;if(void 0!==e&&void 0!==t)for(var s=0;s<n;s++)void 0!==this.items[s][e]&&(this.items[s][e].constructor===Field?this.items[s][e].value===t&&(this.allowMultipleSearch===!0?a.push(this.items[s]):(a.splice(0,a.length),a.push(this.items[s]),i=this.items[s])):this.items[s][e]===t&&(this.allowMultipleSearch===!0?a.push(this.items[s]):(a.splice(0,a.length),a.push(this.items[s]),i=this.items[s])));if(void 0!==e&&void 0===t)for(var s=0;s<n;s++)this.items[s]===e&&(this.allowMultipleSearch===!0?(a.push(this.items[s]),i=this.items[s]):(a.splice(0,a.length),a.push(this.items[s])));return 0!==a.length&&(1===a.length?a[0]:a.length>1?a:void 0)},append:function(e){return void 0!==e&&this.items.push(e),e},delete:function(e,t){var i=0,a=this.items.length;if(void 0!==e&&void 0!==t){console.log("deleting by field and value");for(var n=0;n<this.items.length;n++)void 0!==this.items[n][e]&&(this.items[n][e].constructor===Field?this.items[n][e].value===t&&(this.items.splice(n,1),i++):this.items[n][e]===t&&(this.items.splice(n,1),i++))}if(void 0!==e&&void 0===t){console.log("deleting by value");for(var n=0;n<a;n++)this.items[n]===e&&(this.items.splice(n,1),i++)}return i},clear:function(){return this.items.splice(0,this.items.length),!0},multipleSelect:function(e){if(void 0!==e){if(e.constructor===Boolean)return this.allowMultipleSelect=e,this.allowMultipleSelect;$log.error("$classes 'Collection': Параметр должен быть типа Boolean")}else $log.error("$classes 'Collection': Не указан параметр при установке режима выбора нескольких элементов")},select:function(e,t){var i=[];if(void 0!==e&&void 0!==t)for(var a=this.items.length,n=0;n<a;n++)if(this.items[n].hasOwnProperty(e)){var s=void 0;if(this.items[n][e].constructor===Field?this.items[n][e].value===t&&(console.log("element found",this.items[n]),s=this.items[n]):this.items[n][e]===t&&(s=this.items[n]),void 0!==s)if(this.allowMultipleSelect===!0)i.push(s),this.selectedItems.push(s),void 0!==s._states_&&s._states_.selected(!0);else{i.splice(0,i.length),this.selectedItems.splice(0,this.selectedItems.length),i.push(this.items[n]),this.selectedItems.push(this.items[n]),void 0!==s._states_&&s._states_.selected(!0);for(var r=0;r<a;r++)this.items[r]!==s&&void 0!==this.items[r]._states_&&this.items[r]._states_.selected(!1)}}return console.log("selectedItems = ",this.selectedItems),0!==i.length&&(1===i.length?i[0]:i.length>1?i:void 0)},deselect:function(e){if(void 0!==e)for(var t=this.items.length,i=0;i<t;i++)if(this.items[i]===e){var a=this.selectedItems.length;void 0!==e._states_&&e._states_.selected(!1);for(var n=0;n<a;n++)this.selectedItems[n]===e&&this.selectedItems.splice(n,1)}return console.log(this.selectedItems),this.selectedItems}}),$classesInjector.add("Error",{__dependencies__:[],type:new Field({source:"typeId",type:DATA_TYPE_INTEGER,value:0,default_value:0}),message:new Field({source:"message",type:DATA_TYPE_STRING,value:"",default_value:""}),timestamp:new Field({source:"timestamp",type:DATA_TYPE_INTEGER,value:0,default_value:0})}),$classesInjector.add("File",{_dependencies__:[],title:new Field({source:"title",type:DATA_TYPE_STRING,default_value:"",value:"",backupable:!0,displayable:!0}),type:new Field({source:"type",type:DATA_TYPE_STRING,default_value:"",value:"",backupable:!0,displayable:!0}),size:new Field({source:"size",type:DATA_TYPE_INTEGER,default_value:0,value:0,backupable:!0,displayable:!0}),url:new Field({source:"url",type:DATA_TYPE_STRING,default_value:"",value:"",backupable:!0,displayable:!0})}),$classesInjector.add("Route",{id:void 0,parentId:void 0,order:0,url:void 0,icon:void 0,title:void 0,description:void 0,isActive:!1,isVisible:!0,onSelect:void 0}),$classesInjector.add("Model",{__dependencies__:[],_model_:{__instance__:"",_errors_:[],db_table:"",fromJSON:function(e){var t=0;for(var i in e)for(var a in this.__instance__)if(this.__instance__[a].constructor===Field&&this.__instance__[a].source===i){if(""!==e[i])if(void 0!==this.__instance__[a].type)switch(this.__instance__[a].type){case DATA_TYPE_STRING:this.__instance__[a].value=e[i].toString(),this.__instance__[a]._backup_(e[i].toString());break;case DATA_TYPE_INTEGER:isNaN(e[i])?($log.error("$classes [Model]: Значение поля '"+i+"' в наборе JSON-данных не является числовым значением, свойству объекта присвоен 0"),this.__instance__[a].value=0,this.__instance__[a]._backup_(0)):(this.__instance__[a].value=parseInt(e[i]),this.__instance__[a]._backup_(parseInt(e[i])));break;case DATA_TYPE_FLOAT:isNaN(e[i])?($log.error("$classes [Model]: Значение поля '"+i+"' в наборе JSON-данных не является числовым значением, свойству объекта присвоен 0"),this.__instance__[a].value=0,this.__instance__[a]._backup_(0)):(this.__instance__[a].value=+parseFloat(e[i]).toFixed(6),this.__instance__[a]._backup_(+parseFloat(e[i]).toFixed(6)));break;case DATA_TYPE_BOOLEAN:if(isNaN(e[i])){var n=e[i].toString().toLowerCase();"true"===n||"false"===n?(this.__instance__[a].value="true"===n,this.__instance__[a]._backup_(this.__instance__[a].value)):($log.error("$classes [Model]: Значение поля '"+i+"' в наборе JSON-данных не является интрепретируемым в логическое значение, свойству объекта присвоен false"),this.__instance__[a].value=!1,this.__instance__[a]._backup_(!1))}else{var n=parseInt(e[i]);1===n||0===n?(this.__instance__[a].value=1===n,this.__instance__[a]._backup_(this.__instance__[a].value)):($log.error("$classes [Model]: Значение поля '"+i+"' в наборе JSON-данных не является интрепретируемым в логическое значение, свойству объекта присвоен false"),this.__instance__[a].value=!1,this.__instance__[a]._backup_(!1))}}else isNaN(e[i])===!1?null!==e[i]&&(e[i].constructor===Boolean?this.__instance__[a].value=e[i]:this.__instance__[a].value=parseInt(e[i])):this.__instance__[a].value=e[i];else this.__instance__[a].value="";t++}return void 0!==this.__instance__.onInitModel&&this.__instance__.onInitModel.constructor===Function&&this.__instance__.onInitModel(),t},fromAnother:function(e){if(void 0===e)return $errors.add(ERROR_TYPE_DEFAULT,"Model -> fromAnother: Не задан параметр - объект, на основе которого трекуется провести инициализацию"),!1;for(var t in e){if(null===e[t])return $log.info("Model -> fromAnother: Отсутствует значение (null) свойста '"+t+"' объекта, на основе которого требуется провести инициализаццию"),!1;if(this.__instance__.hasOwnProperty(t))if(isField(this.__instance__[t]))if(void 0!==this.__instance__[t].type)switch(this.__instance__[t].type){case DATA_TYPE_STRING:isField(e[t])?(this.__instance__[t]._fromAnother_(e[t]),this.__instance__[t]._backup_(e[t].value.toString())):(this.__instance__[t].value=e[t].toString(),this.__instance__[t]._backup_(e[t].toString()));break;case DATA_TYPE_INTEGER:var i=isField(e[t])?e[t].value:e[t];isNaN(i)?($log.info("$classes -> Model: Значение поля '"+t+"' в наборе JSON-данных не является числовым значением, свойству объекта присвоен 0"),this.__instance__[t].value=0,this.__instance__[t]._backup_(0)):isField(e[t])?(this.__instance__[t]._fromAnother_(e[t]),this.__instance__[t]._backup_(parseInt(e[t].value))):(this.__instance__[t].value=parseInt(e[t]),this.__instance__[t]._backup_(parseInt(e[t])));break;case DATA_TYPE_FLOAT:isNaN(e[t])?($log.info("$classes -> Model: Значение поля '"+t+"' в наборе JSON-данных не является числовым значением, свойству объекта присвоен 0"),this.__instance__[t].value=0,this.__instance__[t]._backup_(0)):isField(e[fromAnother()])?(this.__instance__[t]._fromAnother_(e[t]),this.__instance__[t]._backup_(+parseFloat(e[t].value).toFixed(6))):(this.__instance__[t].value=+parseFloat(e[t]).toFixed(6),this.__instance__[t]._backup_(+parseFloat(e[t]).toFixed(6)));break;case DATA_TYPE_BOOLEAN:if(isNaN(e[t])){var i=isField(e[t])?e[t].value.toString().toLowerCase():e[t].toString().toLowerCase();"true"===i||"false"===i?(this.__instance__[t].value="true"===i,this.__instance__[t]._backup_(this.__instance__[t].value)):($log.info("$classes -> Model: Значение поля '"+t+"' в наборе JSON-данных не является интрепретируемым в логическое значение, свойству объекта присвоен false"),this.__instance__[t].value=!1,this.__instance__[t]._backup_(!1))}else{var i=isField(e[t])?parseInt(e[t].value):parseInt(e[t]);1===i||0===i?(this.__instance__[t].value=1===i,this.__instance__[t]._backup_(this.__instance__[t].value)):($log.info("$classes -> Model: Значение поля '"+t+"' в наборе JSON-данных не является интрепретируемым в логическое значение, свойству объекта присвоен false"),this.__instance__[t].value=!1,this.__instance__[t]._backup_(!1))}}else isField(e[t])?(this.__instance__[t].value=e[t].value,this.__instance__[t]._backup_(e[t].value)):(this.__instance__[t].value=e[t],this.__instance__[t]._backup_(e[t]));else isField(e[t])?this.__instance__[t]=e[t].value:this.__instance__[t]=e[t]}void 0!==this.__instance__.onInitModel&&this.__instance__.onInitModel.constructor===Function&&this.__instance__.onInitModel()},toString:function(){var e={};for(var t in this.__instance__)this.__instance__[t].constructor===Field&&(e[t]=this.__instance__[t]);return JSON.stringify(e)},reset:function(){var e=0;for(var t in this.__instance__)this.__instance__[t].constructor===Field&&void 0!==this.__instance__[t].default_value&&(this.__instance__[t].value=this.__instance__[t].default_value,e++);return e},_init_:function(){for(var e in this.__instance__)this.__instance__[e].constructor===Field&&void 0!==this.__instance__[e].default_value&&(this.__instance__[e].value=this.__instance__[e].default_value)}}}),$classesInjector.add("Setting",{code:new Field({source:"CODE",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),type:new Field({source:"DATA_TYPE",type:DATA_TYPE_INTEGER,value:0,default_value:0,backupable:!0}),title:new Field({source:"TITLE",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),description:new Field({source:"DESCRIPTION",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),value:new Field({source:"VALUE",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),_onConstruct:function(){if(void 0!==this.value.value&&null!==this.value.value&&""!==this.value.value)switch(this.type.value){case DATA_TYPE_INTEGER:isNaN(this.value.value)?(console.info("$settings -> "+this.title.value+" - значание настройки не соответствует типу данных, присвоен 0"),
this.value.value=0):(this.value.value=parseInt(this.value.value),this.value.type=DATA_TYPE_INTEGER);break;case DATA_TYPE_FLOAT:isNaN(this.value.value)?(console.info("$settings -> "+this.title.value+" - значание настройки не соответствует типу данных, присвоен 0"),this.value.value=0):(this.value.value=parseFloat(this.value.value),this.value.type=DATA_TYPE_FLOAT);break;case DATA_TYPE_STRING:this.value.value=this.value.value.toString();break;case DATA_TYPE_BOOLEAN:isNaN(this.value.value)&&0!==parseInt(this.value.value)&&1!==parseInt(this.value.value)?(console.info("$settings -> "+this.title.value+" - значение настройки не соответствует типу данных, присвоен false"),this.value.value=!1):(this.value.value=new Boolean(parseInt(this.value.value)),this.value.type=DATA_TYPE_BOOLEAN);break;default:console.info("$settings -> "+this.title.value+" - тип данных настройки задан некорректно")}}}),$classesInjector.add("States",{__dependencies__:[],_states_:{isActive:!1,isSelected:!1,isChanged:!1,isLoaded:!0,isLoading:!1,isInEditMode:!1,isInDeleteMode:!1,active:function(e){return void 0!==e&&e.constructor===Boolean&&(this.isActive=e),this.isActive},editing:function(e){return void 0!==e&&e.constructor===Boolean&&(this.isInEditMode=e),this.isInEditMode},deleting:function(e){return void 0!==e&&e.constructor===Boolean&&(this.isInDeleteMode=e),this.isInDeleteMode},changed:function(e){return void 0!==e&&e.constructor===Boolean&&(this.isChanged=e),this.isChanged},selected:function(e){return void 0!==e&&e.constructor===Boolean&&(this.isSelected=e),this.isSelected},loaded:function(e){return void 0!==e&&e.constructor===Boolean&&(this.isLoaded=e),this.isLoaded},loading:function(e){return void 0!==e&&e.constructor===Boolean&&(this.isLoading=e),this.isLoading}}}),$classesInjector.add("TreeItem",{key:0,parentKey:0,display:"",children:{},childrenCount:0,order:0,data:{},isExpanded:!1,isSelected:!1,isChecked:!1,isVisible:!0,notifications:{items:[],add:function(e){if(void 0===e)return $errors.add(ERROR_TYPE_DEFAULT,"TreeItem -> notifications -> add: Не задан параметр - объект с настройками уведомления уведомления"),!1;if(void 0===e.id)return $errors.add(ERROR_TYPE_DEFAULT,"TreeItem -> notifications -> add: Не задана настройка - идентификатор уведомления"),!1;if(void 0===e.value)return $errors.add(ERROR_TYPE_DEFAULT,"TreeItem -> notifications -> add: Не задана настройка - значение уведомления"),!1;var t=factory({classes:["TreeItemNotification"],base_class:"TreeItemNotification"});return t.id=e.id,t.value=e.value,t.icon=void 0!==e.icon?e.icon:"",t.class=void 0!==e.class?e.class:"",t.isVisible=e.isVisible,this.items.push(t),!0},getById:function(e){if(void 0===e)return $errors.add(ERROR_TYPE_DEFAULT,"TreeItem -> notifications -> getById: Не задан параметр - идентификатор уведомления"),!1;for(var t=this.items.length,i=0;i<t;i++)if(this.items[i].id===e)return this.items[i];return!1}},onAddChildren:function(e,t){},onDeleteChildren:function(e){},onSelect:function(e){}}),$classesInjector.add("TreeItemNotification",{id:"",value:0,icon:"",class:"",isVisible:!0}),$classesInjector.add("TreeStructure",{id:"",rootKey:0,expandOnSelect:!1,collapseOnDeselect:!1,showNotifications:!0,class:"",stack:{},initial:{},selectedItem:!1,onAddItem:function(e){}}),$classesInjector.add("Attachment",{_dependencies__:[],id:new Field({source:"ID",type:DATA_TYPE_INTEGER,value:0,default_value:0}),violationId:new Field({source:"VIOLATION_ID",type:DATA_TYPE_INTEGER,value:0,default_value:0}),title:new Field({source:"TITLE",type:DATA_TYPE_STRING,default_value:"",value:"",backupable:!0,displayable:!0}),type:new Field({source:"MIME_TYPE",type:DATA_TYPE_STRING,default_value:"",value:"",backupable:!0,displayable:!0}),size:new Field({source:"SIZE",type:DATA_TYPE_INTEGER,default_value:0,value:0,backupable:!0,displayable:!0}),url:new Field({source:"URL",type:DATA_TYPE_STRING,default_value:"",value:"",backupable:!0,displayable:!0}),added:new Field({source:"DATE_ADDED",type:DATA_TYPE_INTEGER,value:0,default_value:0}),isInAddMode:!1}),$classesInjector.add("Division",{id:new Field({source:"ID",type:DATA_TYPE_INTEGER,value:0,default_value:0}),parentId:new Field({source:"PARENT_ID",type:DATA_TYPE_INTEGER,value:0,default_value:0,bacupable:!0}),sortId:new Field({source:"SORT_ID",type:DATA_TYPE_INTEGER,value:0,default_value:0}),shortTitle:new Field({source:"TITLE_SHORT",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),fullTitle:new Field({source:"TITLE_FULL",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),violationsAdded:new Field({source:"VIOLATIONS_ADDED",type:DATA_TYPE_INTEGER,value:0,default_value:0}),attachmentsAdded:new Field({source:"ATTACHMENTS_ADDED",type:DATA_TYPE_INTEGER,value:0,default_value:0}),storage:new Field({source:"FILE_STORAGE_HOST",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),isDepartment:new Field({source:"IS_DEPARTMENT",type:DATA_TYPE_BOOLEAN,value:!1,default_value:!1,backupable:!0}),path:new Field({source:"PATH",type:DATA_TYPE_STRING,value:"",default_value:""})}),$classesInjector.add("ESKGroup",{id:new Field({source:"ID",type:DATA_TYPE_INTEGER,value:0,default_value:0}),title:new Field({source:"TITLE",type:DATA_TYPE_STRING,value:"",default_value:""}),description:new Field({source:"DESCRIPTION",type:DATA_TYPE_STRING,value:"",default_value:""})}),$classesInjector.add("Violation",{id:new Field({source:"ID",type:DATA_TYPE_INTEGER,value:0,default_value:0}),userId:new Field({source:"USER_ID",type:DATA_TYPE_INTEGER,value:0,default_value:0}),divisionId:new Field({source:"DIVISION_ID",type:DATA_TYPE_INTEGER,value:0,default_value:0,backupable:!0}),eskGroupId:new Field({source:"ESK_GROUP_ID",type:DATA_TYPE_INTEGER,value:0,default_value:0,backupable:!0}),eskObject:new Field({source:"ESK_OBJECT",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),happened:new Field({source:"DATE_HAPPENED",type:DATA_TYPE_INTEGER,value:0,default_value:0}),ended:new Field({source:"DATE_ENDED",type:DATA_TYPE_INTEGER,value:0,default_value:0,backupable:!0}),added:new Field({source:"DATE_ADDED",type:DATA_TYPE_INTEGER,value:0,default_value:0}),description:new Field({source:"DESCRIPTION",type:DATA_TYPE_STRING,value:"",default_value:"",backupable:!0}),isConfirmed:new Field({source:"IS_CONFIRMED",type:DATA_TYPE_BOOLEAN,value:!1,default_value:!1,backupable:!0}),user:0,attachments:[],isNew:!1,newAttachments:0}),$classesInjector.add("ViolationFilter",{code:new Field({source:"",type:DATA_TYPE_STRING,value:"",default_value:""}),title:new Field({source:"",type:DATA_TYPE_STRING,value:"",default_value:""}),startValue:new Field({source:"",type:DATA_TYPE_INTEGER,value:0,default_value:0,backupable:!0}),endValue:new Field({source:"",type:DATA_TYPE_INTEGER,value:0,default_value:0,backupable:!0}),isEnabled:!1,isActive:!1,resetStartValue:function(){this.startValue.value=0},resetEndValue:function(){this.endValue.value=0}}),$classesInjector.add("Weekday",{id:0,title:"",code:""});